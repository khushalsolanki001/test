<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registration Form</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>
<body>
    <section class="hero is-primary is-bold">
        <div class="hero-body">
            <div class="container">
                <h1 class="title">Registration Form</h1>
            </div>
        </div>
    </section>
    <form id="form" class="container m-4 pl-4">
        <div class="field">
            <label class="label">Full Name</label>
            <div class="control">
                <input class="input" type="text" placeholder="Your full name" name="fullName" required>
            </div>
        </div>
        <div class="field">
            <label class="label">Mobile Number</label>
            <div class="control">
                <input class="input" type="tel" placeholder="Your mobile number" name="mobileNumber" pattern="[0-9]{10}" title="Enter a valid 10-digit mobile number" required>
            </div>
        </div>
        <div class="field">
            <label class="label">Ward Number</label>
            <div class="control">
                <input class="input" type="text" placeholder="Your ward number" name="wardNumber" required>
            </div>
        </div>
        <div class="field">
            <label class="label">State</label>
            <div class="control">
                <div class="select is-fullwidth">
                    <select name="state" required>
                        <option value="" disabled selected>Select your state</option>
                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                        <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                        <option value="Assam">Assam</option>
                        <option value="Bihar">Bihar</option>
                        <option value="Chhattisgarh">Chhattisgarh</option>
                        <option value="Goa">Goa</option>
                        <option value="Gujarat">Gujarat</option>
                        <option value="Haryana">Haryana</option>
                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                        <option value="Jharkhand">Jharkhand</option>
                        <option value="Karnataka">Karnataka</option>
                        <option value="Kerala">Kerala</option>
                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                        <option value="Maharashtra">Maharashtra</option>
                        <option value="Manipur">Manipur</option>
                        <option value="Meghalaya">Meghalaya</option>
                        <option value="Mizoram">Mizoram</option>
                        <option value="Nagaland">Nagaland</option>
                        <option value="Odisha">Odisha</option>
                        <option value="Punjab">Punjab</option>
                        <option value="Rajasthan">Rajasthan</option>
                        <option value="Sikkim">Sikkim</option>
                        <option value="Tamil Nadu">Tamil Nadu</option>
                        <option value="Telangana">Telangana</option>
                        <option value="Tripura">Tripura</option>
                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                        <option value="Uttarakhand">Uttarakhand</option>
                        <option value="West Bengal">West Bengal</option>
                        <option value="Andaman and Nicobar Islands">Andaman and Nicobar Islands</option>
                        <option value="Chandigarh">Chandigarh</option>
                        <option value="Dadra and Nagar Haveli and Daman and Diu">Dadra and Nagar Haveli and Daman and Diu</option>
                        <option value="Delhi">Delhi</option>
                        <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                        <option value="Ladakh">Ladakh</option>
                        <option value="Lakshadweep">Lakshadweep</option>
                        <option value="Puducherry">Puducherry</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="field">
            <label class="label">City Name</label>
            <div class="control">
                <input class="input" type="text" placeholder="Your city name" name="cityName" required>
            </div>
        </div>
        <div class="field">
            <label class="label">Village Name</label>
            <div class="control">
                <input class="input" type="text" placeholder="Your village name" name="villageName" required>
            </div>
        </div>
        <div class="field">
            <label class="label">Address</label>
            <div class="control">
                <textarea class="textarea" placeholder="Your full address" name="address" required></textarea>
            </div>
        </div>
        <div class="field is-grouped">
            <div class="control">
                <button class="button is-primary" type="submit" id="submit-button">Submit</button>
            </div>
            <div class="control">
                <button class="button is-danger" type="button" onclick="document.getElementById('form').reset();">Cancel</button>
            </div>
        </div>
    </form>
    <div id="message" style="display: none; margin: 20px; padding: 10px; border-radius: 4px; font-weight: bold;"></div>

    <script>
        const form = document.getElementById("form");
        const submitButton = document.getElementById("submit-button");
        const messageDiv = document.getElementById("message");

        form.addEventListener("submit", async function (e) {
            e.preventDefault();

            const mobileNumber = form.querySelector('input[name="mobileNumber"]').value;
            const mobilePattern = /^\d{10}$/;
            if (!mobilePattern.test(mobileNumber)) {
                messageDiv.textContent = "Please enter a valid 10-digit mobile number.";
                messageDiv.style.display = "block";
                messageDiv.style.backgroundColor = "#f14668";
                messageDiv.style.color = "white";
                return;
            }

            messageDiv.textContent = "Submitting...";
            messageDiv.style.display = "block";
            messageDiv.style.backgroundColor = "beige";
            messageDiv.style.color = "black";
            submitButton.disabled = true;
            submitButton.classList.add("is-loading");

            try {
                const formData = new FormData(this);
                const formDataObj = {};
                for (let [key, value] of formData.entries()) {
                    formDataObj[key] = value;
                }

                const scriptURL = "https://script.google.com/macros/s/AKfycbzrpdz3aa6DbEp9ivHVFJjRyp0Twl7K3ku-1vvaaqEPIff7eF7qRhXKQjsdXgQXxbX6aQ/exec";

                const response = await fetch(scriptURL, {
                    redirect: "follow",
                    method: "POST",
                    body: JSON.stringify(formDataObj),
                    headers: {
                        "Content-Type": "text/plain;charset=utf-8",
                    },
                });

                const data = await response.json();

                if (data.status === "success") {
                    messageDiv.textContent = data.message || "Data submitted successfully!";
                    messageDiv.style.backgroundColor = "#48c78e";
                    messageDiv.style.color = "white";
                    form.reset();
                } else {
                    throw new Error(data.message || "Submission failed");
                }
            } catch (error) {
                console.error("Error:", error);
                messageDiv.textContent = "Error: " + error.message;
                messageDiv.style.backgroundColor = "#f14668";
                messageDiv.style.color = "white";
            } finally {
                submitButton.disabled = false;
                submitButton.classList.remove("is-loading");

                setTimeout(() => {
                    messageDiv.textContent = "";
                    messageDiv.style.display = "none";
                }, 4000);
            }
        });

        const cancelButton = form.querySelector("button.is-danger");
        cancelButton.addEventListener("click", function () {
            form.reset();
            messageDiv.style.display = "none";
        });
    </script>
</body>
</html>
